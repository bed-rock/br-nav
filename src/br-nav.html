<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../br-icons/src/br-icons.html">

<dom-module id="br-nav">

<link rel="import" type="css" href="../dist/css/br-nav.css">
<!-- <script src="br-nav.js"></script> -->

<template>
  <nav class="page-nav">
    <button class="menu--link close_menu" on-click="_toggleMenu">
      <div class="menu--icon">
        <br-icons class="nav-btn-icon" icon="br-icons:close"></br-icons>
      </div>
    </button>

    <ul id="menu" class="menu js-menu">

      <!-- <li class="menu--group"><span>Financeiro</span></li> -->

      <template is="dom-repeat" items="{{items}}">

        <li class$="{{ _getCssClasses(item) }}" on-click="_toggleSubmenu">

          <template is="dom-if" if="{{item.group}}">
            <div class="menu--icon" data-icon="{{item.icon}}">
              <br-icons icon="{{item.icon}}"></br-icons>
            </div>
            <span class="menu--text">{{item.label}}</span><hr>
          </template>          


          <template is="dom-if" if="{{item.icon}}">
            <a href="{{item.link}}" class="menu--link" title="{{item.label}}">              
              <div class="menu--icon" data-icon="{{item.icon}}">
                <br-icons icon="{{item.icon}}"></br-icons>
              </div>
              <span class="menu--text">{{item.label}}</span>
            </a>
          </template>

          <ul class="submenu">
            <template is="dom-repeat" items="{{item.submenu}}">
              <li class="submenu--item">
                <a href="{{item.link}}" class="submenu--link">{{item.label}}</a>
              </li>
            </template>
          </ul>
        </li>

      </template>
    </ul>
  </nav>
</template>

<script>
  Polymer({
    is: 'br-nav',

    properties: {
      items: {
        type: Array,
        value: []
      }
    },

    ready: function () {

    //  this.async(function(){
    //   Polymer.dom(this.$.menu).querySelectorAll('.menu--item__has_submenu');
    // },1);

},

_toggleMenu: function () {
  Polymer.dom(this).classList.toggle('page-nav__opened');
},

_toggleSubmenu: function(e){
  var menuItem = e.target.offsetParent;
  menuItem.classList.toggle('menu--item__has_submenu__opened');
},

_getCssClasses: function(item) {

  if(item.submenu)
    return 'menu--item menu--item__has_submenu';
  else if(item.group)
   return 'menu--group';       
 else
  return 'menu--item';

},

});
</script>

</dom-module>