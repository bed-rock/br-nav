<link rel="import" href="../../polymer/polymer.html">

<dom-module id="br-nav">

<link rel="import" type="css" href="../dist/css/br-nav.css">
<!-- <script src="br-nav.js"></script> -->

<template>

  <nav class="page-nav">

    <button class="menu--link close_menu" on-click="_toggleMenu">
      <div class="menu--icon">
        <svg>
          <use xlink:href="../../br-icons/svgdefs.svg#icon-close"></use>
        </svg>
      </div>
    </button>

    <ul class="menu js-menu">

      <!-- <li class="menu--item  menu--item__has_submenu">
        <a class="menu--link" title="Item 1">
          <div class="menu--icon">
            <svg>
              <use xlink:href="../../br-icons/svgdefs.svg#icon-user"></use>
            </svg>
          </div>
          <span class="menu--text">Item 1</span>
        </a>
        <ul class="submenu">
          <li class="submenu--item">
            <a href="#" class="submenu--link submenu--link__active">Submenu</a>
          </li>
          <li class="submenu--item">
            <a href="#" class="submenu--link">Submenu</a>
          </li>
          <li class="submenu--item">
            <a href="#" class="submenu--link">Submenu</a>
          </li>
        </ul>
      </li>

      <li class="menu--item">
        <a href="#" class="menu--link" title="Item 2">
          <div class="menu--icon">
            <svg>
              <use xlink:href="../../br-icons/svgdefs.svg#icon-user"></use>
            </svg>
          </div>
          <span class="menu--text">Item 2</span>
        </a>
      </li>

      <li class="menu--item">
        <a href="#" class="menu--link" title="Item 3">
          <div class="menu--icon">
            <svg>
              <use xlink:href="../../br-icons/svgdefs.svg#icon-user"></use>
            </svg>
          </div>
          <span class="menu--text">Item 3</span>
        </a>
      </li>

      <li class="menu--item  menu--item__has_submenu">
        <a class="menu--link" title="Item 4">
          <div class="menu--icon">
            <svg>
              <use xlink:href="../../br-icons/svgdefs.svg#icon-user"></use>
            </svg>
          </div>
          <span class="menu--text">Item 4</span>
        </a>
        <ul class="submenu">
          <li class="submenu--item">
            <a href="#" class="submenu--link">Submenu</a>
          </li>
          <li class="submenu--item">
            <a href="#" class="submenu--link">Submenu</a>
          </li>
          <li class="submenu--item">
            <a href="#" class="submenu--link">Submenu</a>
          </li>
        </ul>
      </li>

      <li class="menu--item">
        <a href="#" class="menu--link" title="Item 5">
          <div class="menu--icon">
            <svg>
              <use xlink:href="../../br-icons/svgdefs.svg#icon-user"></use>
            </svg>
          </div>
          <span class="menu--text">Item 5</span>
        </a>
      </li> -->

      <template is="dom-repeat" items="{{items}}">
        <li class="menu--item">
          <a href="{{item.link}}" class="menu--link" title="{{item.label}}">
            <div class="menu--icon" data-icon="{{item.icon}}">
              <svg>
                <use xlink:href="../../br-icons/svgdefs.svg#icon-user"></use>
              </svg>
            </div>
            <span class="menu--text">{{item.label}}</span>
          </a>
        </li>
      </template>

    </ul>

  </nav>

</template>

<script>
  Polymer({
    is: 'br-nav',

    properties: {
      items: {
        type: Array,
        value: []
      }
    },

    created: function () {
      var nav = Polymer.dom(this);
      var menu = Polymer.dom(this).querySelector('.js-menu');
      var item = Polymer.dom(this).querySelectorAll('.menu--item__has_submenu');
    },

    ready: function () {
      _toggleSubmenu;
    },

    _toggleMenu: function () {
      Polymer.dom(this).classList.toggle('page-nav__opened');
    },

    _toggleSubmenu: function () {
      for (var i = 0; i < item.length; i++) {

        if (item[i].classList.contains('menu--item__has_submenu')) {
          item[i].addEventListener('click', function (e) {
            e.preventDefault();

            for (var j = 0; j < item.length; j++) {
              if (this != item[j])
                item[j].classList.remove('menu--item__has_submenu__opened');
            }

            this.classList.toggle('menu--item__has_submenu__opened');

          }, false);
        }
      }
    }

  });
</script>

</dom-module>